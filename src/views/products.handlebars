<h3>Te damos la bienvenida, {{user.name}} | email: {{user.email}} | rol: {{user.role}} | <button id='logout'>Logout</button></h3>

<h1>Productos</h1>

{{#if products.length}}

    <div class='products-container'>
        
        {{#each products}}

                <div class='product-container'>
                    <h3>{{title}}</h3>
                    <img src='{{thumbnail}}'>
                    <p>{{description}}</p>
                    <h4>Categoría: {{category}}</h4>
                    <h4>${{price}}</h4>
                    <h5>Cantidad en stock: {{stock}}</h5>
                    <button id={{id}}>Agregar al carrito</button>
                    <br><br><br><br>
                </div>

        {{/each}}

        {{#if results.hasPrevPage}}
            <button id='prevPage' value={{results.prevLink}}>Ir a página {{results.prevPage}}</button>
        {{/if}}

        {{#if results.hasNextPage}}
            <button id='nextPage' value={{results.nextLink}}>Ir a página {{results.nextPage}}</button>
        {{/if}}

    </div>

{{else}}

    <h2>NO HAY PRODUCTOS</h2>

{{/if}}

<script>
    const prevButton = document.getElementById('prevPage');
    const nextButton = document.getElementById('nextPage');
    const logoutButton = document.getElementById('logout');
    
    if (prevButton) {
        prevButton.addEventListener('click', e => {
            e.preventDefault();
            window.open(e.target.value, '_self')
        })
    }

    if (nextButton) {
        nextButton.addEventListener('click', e => {
            e.preventDefault();
            window.open(e.target.value, '_self')
        })
    }

    if (logoutButton) {
        logoutButton.addEventListener('click', async e => {
            e.preventDefault();
            await fetch('/api/users/logout', {
                method: 'GET',
                withCredentials: true
            })
            .then(window.location.href = '/views/login') 
        })
    }

</script>